<!DOCTYPE html>
<html>
<head>
  <title>Login</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="container">
  <h2>Admin Login</h2>

  <label>Username</label>
  <input id="username">

  <label>Password</label>
  <input type="password" id="password">

  <button onclick="login()">Login</button>
</div>

<script src="js/supabase.js"></script>
<script>
async function login() {
  const enc = new TextEncoder();
  const hash = await crypto.subtle.digest("SHA-256", enc.encode(password.value));
  const password_hash = [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,"0")).join("");

  const { data } = await db
    .from("admin_accounts")
    .select("*")
    .eq("username", username.value)
    .eq("password_hash", password_hash)
    .single();

  if (!data) return alert("Invalid login");

  localStorage.setItem("admin", JSON.stringify(data));
  location.href="index.html";
}
</script>
</body>
</html>
