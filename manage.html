<!DOCTYPE html>
<html>
<head>
  <title>Manage User</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="container" id="box"></div>

<script src="js/supabase.js"></script>
<script>
const id = new URLSearchParams(location.search).get("id");

async function load() {
  const { data:u } = await db.from("drawer_users").select("*").eq("id",id).single();

  box.innerHTML=`
    <h2>${u.name}</h2>
    <p>Status: ${u.is_active ? "ACTIVE":"INACTIVE"}</p>

    <button onclick="toggle(${u.is_active})">
      ${u.is_active ? "Deactivate":"Activate"}
    </button>

    <button onclick="location.href='history.html?uid=${u.id}'">
      View History
    </button>

    <a class="back" href="index.html">â¬… Back</a>
  `;
}

async function toggle(active){
  await db.from("drawer_users")
    .update({ is_active: !active, rfid_uid: active?null:rfid_uid })
    .eq("id",id);
  load();
}
load();
</script>
</body>
</html>
